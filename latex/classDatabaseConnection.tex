\hypertarget{classDatabaseConnection}{}\doxysection{Database\+Connection Class Reference}
\label{classDatabaseConnection}\index{DatabaseConnection@{DatabaseConnection}}


Handles interaction with database when dealing with job requests.  




{\ttfamily \#include $<$Database\+Connection.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classDatabaseConnection_a9671320c3949dd19f794259241666fed}\label{classDatabaseConnection_a9671320c3949dd19f794259241666fed}} 
virtual void {\bfseries connect} (std\+::string ip, int port)
\begin{DoxyCompactList}\small\item\em Connect to the database. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_a9d57fdcc69c82f245388bc44bcb50b91}\label{classDatabaseConnection_a9d57fdcc69c82f245388bc44bcb50b91}} 
virtual void {\bfseries upload\+Job} (\mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job, bool new\+Job)
\begin{DoxyCompactList}\small\item\em Adds a job to the database given the url to a repository and a priority, together with number of previous tries and a timeout. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} \mbox{\hyperlink{classDatabaseConnection_a3f0bc67688bb09f75a83418de32aa7e4}{get\+Top\+Job}} ()
\begin{DoxyCompactList}\small\item\em Retrieves the url of the first job in the jobs table and returns it. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} \mbox{\hyperlink{classDatabaseConnection_a41922e9f0938f1315d2b3839cca3e376}{get\+Current\+Job}} (std\+::string jobid)
\begin{DoxyCompactList}\small\item\em Retrieves a job with matching jobid in the currentjobs table. \end{DoxyCompactList}\item 
virtual long long \mbox{\hyperlink{classDatabaseConnection_a8f9b224f4af7ec56a5b8e451b151a93b}{get\+Current\+Job\+Time}} (std\+::string jobid)
\begin{DoxyCompactList}\small\item\em Retrieves the time of a job with matching jobid in the currentjobs table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_aa15f6858ad9113676748700c50e27364}\label{classDatabaseConnection_aa15f6858ad9113676748700c50e27364}} 
virtual long long {\bfseries add\+Current\+Job} (\mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job)
\begin{DoxyCompactList}\small\item\em Adds a job to the currentjobs table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_aa1d6cd9bd0281571b7ef4b8bc0766843}\label{classDatabaseConnection_aa1d6cd9bd0281571b7ef4b8bc0766843}} 
virtual void {\bfseries add\+Failed\+Job} (\mbox{\hyperlink{structjobTypes_1_1FailedJob}{Failed\+Job}} job)
\begin{DoxyCompactList}\small\item\em Adds a job to the failedjobs table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_aa50bb32d2bff67603dcd900979ea55e1}\label{classDatabaseConnection_aa50bb32d2bff67603dcd900979ea55e1}} 
virtual int {\bfseries get\+Number\+Of\+Jobs} ()
\begin{DoxyCompactList}\small\item\em Returns the amount of jobs in the jobs table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_a14e5ff09fa228c5f616bcfb769fdf2b6}\label{classDatabaseConnection_a14e5ff09fa228c5f616bcfb769fdf2b6}} 
virtual int {\bfseries get\+Crawl\+ID} ()
\begin{DoxyCompactList}\small\item\em Returns the current crawl ID in the database. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_a341375d1c4bb76ebc8ffd1efa22a25ae}\label{classDatabaseConnection_a341375d1c4bb76ebc8ffd1efa22a25ae}} 
virtual void {\bfseries set\+Crawl\+ID} (int id)
\begin{DoxyCompactList}\small\item\em Sets the crawl ID in the database to the given value. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDatabaseConnection_a2896854001ac65b5c5ddc17beeba52ed}\label{classDatabaseConnection_a2896854001ac65b5c5ddc17beeba52ed}} 
virtual void {\bfseries update\+Current\+Jobs} ()
\begin{DoxyCompactList}\small\item\em Regularly updates the current jobs to check for a timeout. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles interaction with database when dealing with job requests. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classDatabaseConnection_a41922e9f0938f1315d2b3839cca3e376}\label{classDatabaseConnection_a41922e9f0938f1315d2b3839cca3e376}} 
\index{DatabaseConnection@{DatabaseConnection}!getCurrentJob@{getCurrentJob}}
\index{getCurrentJob@{getCurrentJob}!DatabaseConnection@{DatabaseConnection}}
\doxysubsubsection{\texorpdfstring{getCurrentJob()}{getCurrentJob()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} Database\+Connection\+::get\+Current\+Job (\begin{DoxyParamCaption}\item[{std\+::string}]{jobid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Retrieves a job with matching jobid in the currentjobs table. 

\begin{DoxyReturn}{Returns}
Job object containing information on job, or nullptr if no match was present. 
\end{DoxyReturn}
\mbox{\Hypertarget{classDatabaseConnection_a8f9b224f4af7ec56a5b8e451b151a93b}\label{classDatabaseConnection_a8f9b224f4af7ec56a5b8e451b151a93b}} 
\index{DatabaseConnection@{DatabaseConnection}!getCurrentJobTime@{getCurrentJobTime}}
\index{getCurrentJobTime@{getCurrentJobTime}!DatabaseConnection@{DatabaseConnection}}
\doxysubsubsection{\texorpdfstring{getCurrentJobTime()}{getCurrentJobTime()}}
{\footnotesize\ttfamily long long Database\+Connection\+::get\+Current\+Job\+Time (\begin{DoxyParamCaption}\item[{std\+::string}]{jobid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Retrieves the time of a job with matching jobid in the currentjobs table. 

\begin{DoxyReturn}{Returns}
The time of the job. Returns -\/1 if job is unknown or an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{classDatabaseConnection_a3f0bc67688bb09f75a83418de32aa7e4}\label{classDatabaseConnection_a3f0bc67688bb09f75a83418de32aa7e4}} 
\index{DatabaseConnection@{DatabaseConnection}!getTopJob@{getTopJob}}
\index{getTopJob@{getTopJob}!DatabaseConnection@{DatabaseConnection}}
\doxysubsubsection{\texorpdfstring{getTopJob()}{getTopJob()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} Database\+Connection\+::get\+Top\+Job (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Retrieves the url of the first job in the jobs table and returns it. 

\begin{DoxyReturn}{Returns}
Job object containing data on the top job. 
\end{DoxyReturn}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
Search\+SECODatabase\+API/\+Job\+Distribution/Database\+Connection.\+h\item 
Search\+SECODatabase\+API/\+Job\+Distribution/Database\+Connection.\+cpp\end{DoxyCompactItemize}
