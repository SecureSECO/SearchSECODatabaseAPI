

The database API is responsible for handling the communication between the controller and the database.\hypertarget{md_README_autotoc_md1}{}\doxysection{Installation}\label{md_README_autotoc_md1}
To install the program you should clone the git repository.\hypertarget{md_README_autotoc_md2}{}\doxysubsection{Dependencies}\label{md_README_autotoc_md2}
The database api code has the following dependencies\+:
\begin{DoxyItemize}
\item Cassandra
\item Datastax cpp-\/driver
\item Boost-\/asio
\end{DoxyItemize}

For running the program using Docker you need the following dependencies installed\+:
\begin{DoxyItemize}
\item \href{https://docs.docker.com/get-docker/}{\texttt{ Docker}}
\item \href{https://docs.docker.com/compose/install/}{\texttt{ Docker compose}}
\end{DoxyItemize}

If you want to build the program locally in Linux you will need to perform the following commands to get the required dependencies\+:
\begin{DoxyItemize}
\item {\ttfamily sudo apt-\/get install libboost-\/all-\/dev}
\item {\ttfamily wget \href{http://archive.ubuntu.com/ubuntu/pool/main/g/glibc/multiarch-support_2.27-3ubuntu1.4_amd64.deb}{\texttt{ http\+://archive.\+ubuntu.\+com/ubuntu/pool/main/g/glibc/multiarch-\/support\+\_\+2.\+27-\/3ubuntu1.\+4\+\_\+amd64.\+deb}}}
\item {\ttfamily sudo dpkg -\/i multiarch-\/support\+\_\+2.\+27-\/3ubuntu1.\+4\+\_\+amd64.\+deb}
\item {\ttfamily apt-\/get install libssl-\/dev libkrb5-\/dev zlib1g}
\item {\ttfamily wget \href{https://downloads.datastax.com/cpp-driver/ubuntu/18.04/dependencies/libuv/v1.35.0/libuv1_1.35.0-1_amd64.deb}{\texttt{ https\+://downloads.\+datastax.\+com/cpp-\/driver/ubuntu/18.\+04/dependencies/libuv/v1.\+35.\+0/libuv1\+\_\+1.\+35.\+0-\/1\+\_\+amd64.\+deb}}}
\item {\ttfamily dpkg -\/i libuv1\+\_\+1.\+35.\+0-\/1\+\_\+amd64.\+deb}
\item {\ttfamily wget \href{https://downloads.datastax.com/cpp-driver/ubuntu/18.04/cassandra/v2.15.3/cassandra-cpp-driver_2.15.3-1_amd64.deb}{\texttt{ https\+://downloads.\+datastax.\+com/cpp-\/driver/ubuntu/18.\+04/cassandra/v2.\+15.\+3/cassandra-\/cpp-\/driver\+\_\+2.\+15.\+3-\/1\+\_\+amd64.\+deb}}}
\item {\ttfamily dpkg -\/i cassandra-\/cpp-\/driver\+\_\+2.\+15.\+3-\/1\+\_\+amd64.\+deb}
\end{DoxyItemize}\hypertarget{md_README_autotoc_md3}{}\doxysubsection{Building}\label{md_README_autotoc_md3}
There are two different ways of building the program. You can simply run it using Docker, this is the easiest if you just want to run the program. The other way is to locally build the program using {\ttfamily cmake} on Linux.\hypertarget{md_README_autotoc_md4}{}\doxysubsubsection{Docker}\label{md_README_autotoc_md4}
In order to start the program using Docker you should first set the variables in the {\ttfamily .env} file. The {\itshape LOC} is for the location of the data to store, {\itshape SEEDS} is for the IP-\/addresses of the nodes to connect to and the {\itshape IP} is for the public IP-\/address of the current computer. In order to contact the rest of the database you should also open ports {\ttfamily 8001} and {\ttfamily 8002}. You can then start the program using {\ttfamily docker-\/compose up -\/d} in the main folder of the repository. This will automatically have your computer join the distributed database. After this the API should be listening on port {\ttfamily 8003} for requests.\hypertarget{md_README_autotoc_md5}{}\doxysubsubsection{Linux}\label{md_README_autotoc_md5}
In order to build the program using {\ttfamily cmake} you should preform the following commands\+:
\begin{DoxyItemize}
\item {\ttfamily mkdir build}
\item {\ttfamily cd build}
\item {\ttfamily cmake ..}
\item {\ttfamily cmake -\/-\/build .}
\end{DoxyItemize}

The Database API can then be started using {\ttfamily ./\+Database-\/\+API/\+Database-\/\+API}.\hypertarget{md_README_autotoc_md6}{}\doxysection{Usage}\label{md_README_autotoc_md6}
The database API can handle multiple different requests. Every request has a different four-\/letter identifier which should be specified in the input. After the identifier the length of the input data should be specified, this is the number of ASCII characters (so {\ttfamily \textbackslash{}n} has a length of 1). Following this should be the input data in the specific format required by the request. The database API supports the following requests for uploading to and extracting from the database\+:
\begin{DoxyItemize}
\item The {\ttfamily check} request can be used to check if a method or multiple methods are present in the database.
\item The {\ttfamily upload} request can be used to upload or update a project with its specified methods.
\item The {\ttfamily check upload} request can be used to match the input data to existing entries in the database, matches will show up on the command-\/line. After this, the project and methods will be added to the database.
\item The {\ttfamily extract projects} request can be used to retrieve the information of projects given their {\ttfamily project\+ID}.
\item The {\ttfamily get author} request can be used to get the name and email corresponding to an author ID.
\item The {\ttfamily get method by author} request can be used to get the methods that an author has worked on.
\item The {\ttfamily get previous project} request can be used to get the most recent project of a repository in the database.
\end{DoxyItemize}

The API also supports the following requests for the job distribution system\+:
\begin{DoxyItemize}
\item The {\ttfamily connect} request can be used to connect a new node to the network.
\item The {\ttfamily upload job} request can be used to upload multiple jobs to the jobsqueue.
\item The {\ttfamily upload crawl data} request can be used to both upload new jobs and update the crawl id.
\item The {\ttfamily get top job} request can be used to get a job.
\end{DoxyItemize}\hypertarget{md_README_autotoc_md7}{}\doxysubsubsection{Stopping}\label{md_README_autotoc_md7}
To stop the program you should first tell it to leave the distributed database by using {\ttfamily docker exec cassandra nodetool decommision}. After this you can use {\ttfamily docker stop api} and {\ttfamily docker stop cassandra} to stop the containers.\hypertarget{md_README_autotoc_md8}{}\doxysubsubsection{Running tests}\label{md_README_autotoc_md8}
To locally run the tests(including integration tests) you can first use {\ttfamily docker build -\/f Testing\+Dockerfile -\/t testing .} in the main folder to build the container. After this you can use {\ttfamily docker run -\/-\/name test\+Container testing} to actually run the tests. This will also generate the code coverage. To copy the code coverage files to a local folder you can use {\ttfamily docker cp test\+Container\+:/build/coverage ./coverage}. After this you can open {\itshape index.\+html} in the coverage folder to see the code coverage.\hypertarget{md_README_autotoc_md9}{}\doxysubsection{Dashboard}\label{md_README_autotoc_md9}
To run the dashboard on a server you should first create a file called {\ttfamily prometheus.\+yml} based on the \href{https://prometheus.io/docs/prometheus/latest/configuration/configuration/}{\texttt{ example}}. This should contain the ip addresses of the servers with port {\ttfamily 8000}. After this you can use the following commands to start the dashboard\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{docker run -\/p 9090:9090 -\/p 80:3000 -\/v /path/to/file:/etc/prometheus -\/d -\/-\/name=prometheus prom/prometheus}
\DoxyCodeLine{docker run -\/d -\/-\/network=container:prometheus -\/-\/name=grafana grafana/grafana}

\end{DoxyCode}
 You can then use the ip address of the server you host the dashboard on to access the dashboard.\hypertarget{md_README_autotoc_md10}{}\doxysection{License}\label{md_README_autotoc_md10}
This project is licensed under the GNU Affero General Public License v3.\+0. See \mbox{[}LICENSE\mbox{]}(LICENSE) for more info.

This program has been developed by students from the bachelor Computer Science at Utrecht University within the Software Project course. Â© Copyright Utrecht University (Department of Information and Computing Sciences)\hypertarget{md_README_autotoc_md11}{}\doxysubsection{Licenses for code from other projects}\label{md_README_autotoc_md11}

\begin{DoxyItemize}
\item \href{https://cassandra.apache.org/}{\texttt{ Cassandra}}. The license for Cassandra, Cassandra exporter agent and \href{https://github.com/datastax/cpp-driver}{\texttt{ Datastax cpp driver}} can be found in \href{external/LICENSE.txt}{\texttt{ external/\+LICENSE}}. 
\end{DoxyItemize}