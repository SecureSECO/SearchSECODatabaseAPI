\hypertarget{DatabaseConnection_8h_source}{}\doxysection{Database\+Connection.\+h}
\label{DatabaseConnection_8h_source}\index{SearchSECODatabaseAPI/JobDistribution/DatabaseConnection.h@{SearchSECODatabaseAPI/JobDistribution/DatabaseConnection.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{This program has been developed by students from the bachelor Computer Science at}}
\DoxyCodeLine{3 \textcolor{comment}{Utrecht University within the Software Project course.}}
\DoxyCodeLine{4 \textcolor{comment}{Â© Copyright Utrecht University (Department of Information and Computing Sciences)}}
\DoxyCodeLine{5 \textcolor{comment}{*/}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}JobTypes.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <cassandra.h>}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#define IP "{}cassandra"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define DBPORT 8002}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define UPDATE\_JOBS\_TIMEOUT 300000000 }\textcolor{comment}{// 5 minutes.}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#define MAX\_JOB\_RETRIES 1}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define RECOUNT\_WAIT\_TIME 600}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{using namespace }jobTypes;}
\DoxyCodeLine{20 }
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classDatabaseConnection}{DatabaseConnection}}}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26 \textcolor{keyword}{public}:}
\DoxyCodeLine{30     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classDatabaseConnection_a9671320c3949dd19f794259241666fed}{connect}}(std::string ip, \textcolor{keywordtype}{int} port);}
\DoxyCodeLine{31 }
\DoxyCodeLine{36     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classDatabaseConnection_a9d57fdcc69c82f245388bc44bcb50b91}{uploadJob}}(\mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job, \textcolor{keywordtype}{bool} newJob);}
\DoxyCodeLine{37 }
\DoxyCodeLine{42     \textcolor{keyword}{virtual} \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} \mbox{\hyperlink{classDatabaseConnection_a3f0bc67688bb09f75a83418de32aa7e4}{getTopJob}}();}
\DoxyCodeLine{43 }
\DoxyCodeLine{51     \textcolor{keyword}{virtual} \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} \mbox{\hyperlink{classDatabaseConnection_a41922e9f0938f1315d2b3839cca3e376}{getCurrentJob}}(std::string jobid);}
\DoxyCodeLine{52 }
\DoxyCodeLine{59     \textcolor{keyword}{virtual} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \mbox{\hyperlink{classDatabaseConnection_a8f9b224f4af7ec56a5b8e451b151a93b}{getCurrentJobTime}}(std::string jobid);}
\DoxyCodeLine{60 }
\DoxyCodeLine{64     \textcolor{keyword}{virtual} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \mbox{\hyperlink{classDatabaseConnection_aa15f6858ad9113676748700c50e27364}{addCurrentJob}}(\mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job);}
\DoxyCodeLine{65 }
\DoxyCodeLine{69     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classDatabaseConnection_aa1d6cd9bd0281571b7ef4b8bc0766843}{addFailedJob}}(\mbox{\hyperlink{structjobTypes_1_1FailedJob}{FailedJob}} job);}
\DoxyCodeLine{70 }
\DoxyCodeLine{74     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \mbox{\hyperlink{classDatabaseConnection_aa50bb32d2bff67603dcd900979ea55e1}{getNumberOfJobs}}();}
\DoxyCodeLine{75 }
\DoxyCodeLine{79     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \mbox{\hyperlink{classDatabaseConnection_a14e5ff09fa228c5f616bcfb769fdf2b6}{getCrawlID}}();}
\DoxyCodeLine{80 }
\DoxyCodeLine{84     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classDatabaseConnection_a341375d1c4bb76ebc8ffd1efa22a25ae}{setCrawlID}}(\textcolor{keywordtype}{int} \textcolor{keywordtype}{id});}
\DoxyCodeLine{85 }
\DoxyCodeLine{89     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classDatabaseConnection_a2896854001ac65b5c5ddc17beeba52ed}{updateCurrentJobs}}();}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{keyword}{private}:}
\DoxyCodeLine{95     \textcolor{keywordtype}{void} deleteTopJob(CassUuid \textcolor{keywordtype}{id}, cass\_int64\_t priority);}
\DoxyCodeLine{96 }
\DoxyCodeLine{100     \textcolor{keywordtype}{void} deleteCurrentJob(CassUuid \textcolor{keywordtype}{id});}
\DoxyCodeLine{101 }
\DoxyCodeLine{105     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \mbox{\hyperlink{classDatabaseConnection_aa15f6858ad9113676748700c50e27364}{addCurrentJob}}(CassUuid \textcolor{keywordtype}{id}, \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job);}
\DoxyCodeLine{106 }
\DoxyCodeLine{110     \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} retrieveCurrentJob(\textcolor{keyword}{const} CassRow *row);}
\DoxyCodeLine{111 }
\DoxyCodeLine{115     \textcolor{keywordtype}{void} setPreparedStatements();}
\DoxyCodeLine{116 }
\DoxyCodeLine{120     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} updateCurrentJob(CassUuid jobid, \mbox{\hyperlink{structjobTypes_1_1Job}{Job}} job, \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} currentTime);}
\DoxyCodeLine{121 }
\DoxyCodeLine{125     CassSession *connection;}
\DoxyCodeLine{126 }
\DoxyCodeLine{127     \textcolor{keywordtype}{int} numberOfJobs;}
\DoxyCodeLine{128     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} timeLastRecount = -\/1;}
\DoxyCodeLine{129 }
\DoxyCodeLine{130     \textcolor{keyword}{const} CassPrepared *preparedGetTopJob;}
\DoxyCodeLine{131     \textcolor{keyword}{const} CassPrepared *preparedDeleteTopJob;}
\DoxyCodeLine{132     \textcolor{keyword}{const} CassPrepared *preparedAddCurrentJob;}
\DoxyCodeLine{133     \textcolor{keyword}{const} CassPrepared *preparedGetCurrentJob;}
\DoxyCodeLine{134     \textcolor{keyword}{const} CassPrepared *preparedGetCurrentJobs;}
\DoxyCodeLine{135     \textcolor{keyword}{const} CassPrepared *preparedDeleteCurrentJob;}
\DoxyCodeLine{136     \textcolor{keyword}{const} CassPrepared *preparedAddFailedJob;}
\DoxyCodeLine{137     \textcolor{keyword}{const} CassPrepared *preparedAmountOfJobs;}
\DoxyCodeLine{138     \textcolor{keyword}{const} CassPrepared *preparedUploadJob;}
\DoxyCodeLine{139     \textcolor{keyword}{const} CassPrepared *preparedUploadRetryJob;}
\DoxyCodeLine{140     \textcolor{keyword}{const} CassPrepared *preparedCrawlID;}
\DoxyCodeLine{141     \textcolor{keyword}{const} CassPrepared *preparedUpdateCrawlID;}
\DoxyCodeLine{142 \};}
\DoxyCodeLine{143 }

\end{DoxyCode}
